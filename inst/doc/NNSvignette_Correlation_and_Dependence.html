<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fred Viole" />


<title>Getting Started with NNS: Correlation and Dependence</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Getting Started with NNS: Correlation and Dependence</h1>
<h4 class="author">Fred Viole</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NNS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rgl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(meboot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(plyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tdigest)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dtw)</span></code></pre></div>
<div id="correlation-and-dependence" class="section level1">
<h1>Correlation and Dependence</h1>
<p>The limitations of linear correlation are well known. Often one uses correlation, when dependence is the intended measure for defining the relationship between variables. NNS dependence <code>NNS.dep</code> is a signal:noise measure robust to nonlinear signals.</p>
<p>Below are some examples comparing NNS correlation <code>NNS.cor</code> and <code>NNS.dep</code> with the standard Pearson’s correlation coefficient <code>cor</code>.</p>
<div id="linear-equivalence" class="section level2">
<h2>Linear Equivalence</h2>
<p>Note the fact that all observations occupy the co-partial moment quadrants.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, .<span class="dv">01</span>) ; y <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> x</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] 1
## 
## $Dependence
## [1] 1</code></pre>
</div>
<div id="nonlinear-relationship" class="section level2">
<h2>Nonlinear Relationship</h2>
<p>Note the fact that all observations occupy the co-partial moment quadrants.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, .<span class="dv">01</span>) ; y <span class="ot">=</span> x <span class="sc">^</span> <span class="dv">10</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtGgrRmAABmOgBmOjpmkJBmkLZmtrZmtttmtv+QOgCQOjqQZjqQZmaQkGaQtraQttuQ27aQ2/+2ZgC2Zjq2kGa2kLa2tpC227a229u22/+2///bkDrbtmbbtpDb27bb2//b////AAD/tmb/25D/27b/29v//7b//9v///8PFpndAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM90lEQVR4nO2dCX+cuBmHceydaeNskzWTbZpxN1s3xG03JVdnfPD9v1dB4pAEAr2MAPHO/9mfsx6MDvSgExiiDLAmWjoDYFogmDkQzBwIZg4EMweCmQPBzIFg5kAwcyCYORDMHAhmDgQzB4KZA8HMgWDmQDBzIJg5EMwcCGYOBDMHgpkDwcyBYOZAMHMgmDkQzBwIZk6wgp9voyh68V/lw8a6VXy4v84/RZev77rje/gg/n797vtQygclCR98/XWbx/jq7oe/KAmELbjSpwtubc1Jo5qrj+3YHt42f3/9uT9lv4KblLvyNT2BC7742HzYWLdmWRKp7M3IDlv1zxf9Je1V8HHrnO40BC649GcINrcKJwqmnuNW/3t/SfsUXOa35KcFWunQBcvaaAru3PpL0bt+e9uuwk87YbXofR/vt11ngIZPweLUusr7hK/bhapw8ILFWd8SrG8VBm9kOPX3EtE/vyh73gdhW99Bx6fgtNZ66Ow7pid4waJQWoL1rULq3haT+GtTeUSlEgKLjnv/8Pf831eF/ef7l/ko/L0m+Ouv+YfLN9XI2wjRbFTZNElnX66vt7Jh7jjxZiF8wUVZtwVrWw2FBgej1JPqBCl++duuiq3qqH/6Ugt+qkfAN03QJoQan0VwQ/9JOB1hC77cysLVBbe2lmV81T3VTI3G8VAZa8zcmAMx4U/23ao1LUSFm+BD3zk4IWEL3iSysHXBra2Nnct3bceJUbRi5035h+jifZNc9MsPORpqmvCLu7yd3VZniBpCi39QsIgfo2gFaU9Uoo0p2NyqrXNcGuWfJXqLagi+UTbe1L9VbbY8MdJKjhqCRt0vzE3ggsthqCHY3JqV05ASfclIW90sKE8PvWqnzU7VCZHWsRchxI5mY+DMJ3vbPTGhC5Y2TMHGVrH/l5e1Yc1BS7BWg6s/JE0LmiodwE0TxT5rNwauxyLq7xINdPiC5ZDovSHY2FryeF851sqytw8u91TPlXKapA6xqpY56fI02AfL/v3K4/ULAsELFv+/emsI1rcqoaRjrQr3jqLdBRunRMOQYOl3mfq7AsHNOvPGulXji+Gzfx5clXsymWA5mV5giUMSvuC6ADe2rVpf3F4yMpZBhO96GqQKtvbBNSMEi2jMmdWMrEBwNcndWLdqc5D2oq+2Fi3DCXGqro5RdNKS1S14+DAWuU5YsgLB1SR3Y90qnF6IFWN5uUgvUdvVJFVXxzy4Y+2JLtgcAMzOGgSXveHGunWoGzx0Xw/WdIkotJWsunF9/nTxl398b4VwwbgSjYsNDe37cTbWrcpVAUHLgXFHx15u1XTpYypRxTU7rV7biTTSgOAGVWVzJ1b31vz335RifNNWoN6T9XN1pU/XVe1y8c9d1YYroa4+t0M4HgQEd6INjeuZTvfWgsf7a9H7vrLcNvnwu7yr8q/6hVxFl7we/O770y5SrgcXkV6+/qMzxCDmvUIQDHwDwcyBYOZAMHMgmDkQzBwIZg4EMweCmQPBzIFg5kAwcyCYORDMHAhmDgQzB4KZA8HMgWDmQDBzIJg5EMwcCGYOBDMHgpkDwczxLDgCM7GUYL/RgYY4jpVPEMyNuPwpmVkwveUANGLl3wLUYGZAMHNi0QVD8DhWkGuhd7k+eKroZmKRXJMSjas6TA4NwUtBE2y00BDMDDlJguCRBJ/r2JwGQzCJ4PvgWDImNAQvBaGoyv4XgplS6lX9QjCJwHPdbqAhmEbgfXBrCE0JDcFL4VxU7SE0JTQEB09XCw3BJMLOdVcLDcEkgu6DO1toXPAPH2fBXS00ajAfOltoCCYRcq67W2gIJhFyH9zdQkNw+LgKzrpaaAjmgqWFhmASAefa0kJDMImA+2BLCw3B4eNUVK17sUihSTsuEt3Z07qbsgKCKQSba6kWgk8l2D7Y2kJDcPg4Cba10BDMAnsFnkpw9TbN6t2NJ0YXCqHm2l6BJxKcVq/PPNjeoxlqUfUTaB9sH2JNJPj5ttaaWl6yuk7Bi+AiuHuZ0i00dceseEn2vvr1YGmkIdgfcU8LPXcNXvkdHUHmuhxhdfudrA/ey1/QB0+fqGiebX6nGkUXbz8vsL7mfJ2CF2GgqPpGWMOhR+y4SHRnTM8cuACCKYSY674RVoaFDhoB9sEDFRgLHeEzILi/AmOhY+X0z5EyLHTQCC/XcfmfFdRgCsH1wbHtXjun0ON2LOC60LEIvYKHKjAWOlbNcAUmCn7+l00YlXUKDi3XwxWYKDivmJfvvDgOrajcCKwPdqjA1Br8aZu3u1d3g46ZLnQsQo/g4QpM74O//ebgGAsdc+BSgUcNsqTjV3fWfTFNmgWXCjx2FP3tQ+H49efufe0LHbjg7y/Rou4OVuCRgh/vX0pNbzrrJ9savAiWooqHLjP0hu7b8fFe1N4/suzrNtp07oyFjskRrfNwBSYLlnar/ve4tQyTmS50hJNr6XbYL30erI2gn3bWeZCvdIMinD64907KwdDWHZ92+jrHwwf7UNpTuqCrqAavEvaG7tnxu+PeWOiYFsf2OcMdHTRCybVzA43rwTQC6YPdG2jc0bECOgW7VmDU4BUi9DpWYNzRQSKIXLvOgCW4o4NCEH0wpYHGkw0rwCgqUgMNwauD1kBPK/gQRRcf/UUXAMvnumqflxacRNHN8ecf6oTplOhCYfE+WPgdvspvCe1nx4IkH1wlovZimnQySlGVft3r75QLHcc/FYJ53dGxMCP8TiW4mP0+F1cmeNXgZXM9xu9UCx1VvZWqT40uGBbtg52v8XeG9rejIJXD50O1onVidGeNJpjqF/Pg1TDOLwSTWC7X5PlvBQRTWKwPrvtfCOZH1LxShe4XgtdAHI/sgDMIpjF7rv8nKfvfEX4hmMRSgrNx/W8BBAeNWoPHxQDBQVMJHu0Xgkn4yHVxncXxJ45KwVEUU8KNyjIEZ3PnOq+2dQ0eHQkEh4oYNtd98GggOFBiVfAJ8cwseOUX/GfLdb1ydcLwSoIaTGGeXMc6pyUKwaFRr0pW1ReCOWHU3tMjhGAKU+daVevHLwSTmDLXulpFL5poDsRtqj9B8OrpsOujdRZAMAX/ue5y689uBsE0/Oa6y2yHXjTR66O73lpqLwSvCYvUKRpnCQRTGJvrvho7Sc/bAMEU+nPdXPpxE+qoN8gmmvZVhnEUxV5/qsuovuPt/6luvxgTlnSnx/J3dNC+ynDM+d6PcivTjGipDh+Vj4uBw0wimPZFaFMXtUciz6kSynQskwimvbMh9t9chtxEz6a2LHHvO2aMa7CPVAnl6IOp+uC9/OV8+2ADSul5ZaJRNO2rDGct6nkgldaUYB7MnMUEg5lYSLCXyMfmaeZw68gmBDPPJgQzzyYEM88mBDPPJgQzzyYEM88mBDPPJgQzzybWFpkDwcyBYOZAMHMgmDkQzBwIZg4EMweCmQPBzIFg5kAwcyCYOVMI1t4g3fc6aXsweYf9xjHB45/rJ6Xck9PCuacnnqCtn+twT04LRzm8dFxpVkwg+JBn4VBlQ/vgHky+xNaRp139KJx7cno45/Seb/PY08qNe3J6OMLhFS8EHVGaNf4Fy0fUkk37g3sw8+nFXg7NA+nuyenh3NM7bvdZ/RpWQnJaOMLhife8Pt9SS7PBv2DtUPTjcg6Wpe4HcYhu6vJyT04PR0lPhJW1iJKcGo6aXCWYnF42iWD1FeGd7wsfDpYl12pPN0Qj2Dk5PRwxvSyhHp0ejppc+VZfenrZFILlWVqeq9oH92BPu+L5xcS1COpDdk9OD0dNr5RDTK4OR0vuUJ8L1PQKwhRcbiLXxLGCaekd1DEWJTl93OxeE59v5fO6YQj20kTLTaLLceD0JpqSXvP0Oy0586l558Nr+vwgmmgvgyy5yXUyMWqQlbUFO6WXNp5IyaVmp0uYK5XnQhiDLB/TJHkk9JpInEcYJ4ZTevXXWBCTU8MRktN2DWOa5GWhQxwEfZBFXAlQRtGu6R236k7uyenhCIeX5N1v/e03QSx01ItrcvaWOi+uacGSfB6xd01QiKImp4dzTS+Vz9dffCQmZ4QjHF6564jDE+BiA3MgmDkQzBwIZg4EMweCmQPBzIFg5kAwcyCYORDMHAhmDgQzB4KZA8HMgWDmQDBzIJg5EMwcCGYOBDMHgpkDwcyBYOZAMHMgmDnnLfggHwQ5bonPg6yI8xacJZF4tovwdQpr48wFH7e524P9hdfr58wFZ2n04j879+cY18e5CxZfQEf7UqN1ce6Cta9D48jZC86rMOMeGILFo/d8x9AQfNy++DfjWfDZCxZT4ITzKOvMBYspcD4Z3i+dkck4b8FPO9E6p4wH0uctuGycn3Z8x1nnLfgMgGDmQDBzIJg5EMwcCGYOBDMHgpkDwcyBYOZAMHMgmDkQzBwIZg4EMweCmQPBzIFg5kAwcyCYORDMHAhmDgQzB4KZ83/WIW1MCXdmFQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 0.6610183</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] 0.9878161
## 
## $Dependence
## [1] 0.9998908</code></pre>
</div>
<div id="dependence" class="section level2">
<h2>Dependence</h2>
<p>Note the fact that all observations occupy only co- or divergent partial moment quadrants for a given subquadrant.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, (x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span> <span class="sc">&gt;=</span> <span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] -0.3046437
## 
## $Dependence
## [1] 0.9791481</code></pre>
</div>
</div>
<div id="p-values-for-nns.dep" class="section level1">
<h1>p-values for <code>NNS.dep()</code></h1>
<p>p-values and confidence intervals can be obtained from sampling random permutations of <span class="math inline">\(y \rightarrow y_p\)</span> and running <code>NNS.dep(x,$y_p$)</code> to compare against a null hypothesis of 0 correlation, or independence between <span class="math inline">\((x, y)\)</span>.</p>
<p>Simply set <code>NNS.dep(..., p.value = TRUE, print.map = TRUE)</code> to run 100 permutations and plot the results.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p-values for [NNS.dep]</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">1</span>); y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y, <span class="at">p.value =</span> <span class="cn">TRUE</span>, <span class="at">print.map =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>## $Correlation
## [1] 0.09409674
## 
## $`Correlation p.value`
## [1] 0.1
## 
## $`Correlation 95% CIs`
## [1] -0.1247867  0.1592035
## 
## $Dependence
## [1] 0.7151583
## 
## $`Dependence p.value`
## [1] 0
## 
## $`Dependence 95% CIs`
## [1] 0.1115190 0.2905444</code></pre>
</div>
<div id="multivariate-dependence-nns.copula" class="section level1">
<h1>Multivariate Dependence <code>NNS.copula()</code></h1>
<p>These partial moment insights permit us to extend the analysis to multivariate instances and deliver a dependence measure <span class="math inline">\((D)\)</span> such that <span class="math inline">\(D \in [0,1]\)</span>. This level of analysis is simply impossible with Pearson or other rank based correlation methods, which are restricted to bivariate cases.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>); y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>); z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(<span class="fu">cbind</span>(x, y, z), <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">independence.overlay =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.09571785</code></pre>
</div>
<div id="simulating-a-multivariate-dependence-structure" class="section level1">
<h1>Simulating a Multivariate Dependence Structure</h1>
<p>Analogous to an empirical copula transformation, we can generate <code>new data</code> from the dependence structure of our <code>original data</code> via the following steps:</p>
<ul>
<li><strong>Determine the dependence structure:</strong></li>
</ul>
<p>This is accomplished using <code>LPM.ratio(1, x, x)</code> for continuous variables, and <code>LPM.ratio(0, x, x)</code> for discrete variables, which are the empirical CDFs of the marginal variables.</p>
<ul>
<li><strong>Generate or supply <code>new data</code>:</strong></li>
</ul>
<p><code>new data</code> must be of equal dimensions to <code>original data</code>. <code>new data</code> does not have to be of the same distribution as the <code>original data</code>, nor does each dimension of <code>new data</code> have to share a distribution type.</p>
<ul>
<li><strong>Apply dependence structure to <code>new data</code>:</strong></li>
</ul>
<p>We then utilize <code>LPM.VaR(...)</code> to ascertain <code>new data</code> values corresponding to <code>original data</code> position mappings, and return a matrix of these transformed values with the same dimensions as <code>original.data</code>.<br />
<code>LPM.VaR(..., degree = 0, ...)</code> is the discrete transformation and significantly faster than the continuous transformation <code>LPM.VaR(..., degree = 1, ...)</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add variable x to original data to avoid total independence (example only)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>original.data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y, z, x)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine dependence structure</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>dep.structure <span class="ot">&lt;-</span> <span class="fu">apply</span>(original.data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">LPM.ratio</span>(<span class="dv">1</span>, x, x))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate new data of equal dimensions to original data with different mean and sd (or distribution)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(original.data), <span class="cf">function</span>(x) <span class="fu">rnorm</span>(<span class="fu">dim</span>(original.data)[<span class="dv">1</span>], <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">20</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply dependence structure to new data</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>new.dep.data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(original.data), <span class="cf">function</span>(x) <span class="fu">LPM.VaR</span>(dep.structure[,x], <span class="dv">1</span>, new.data[,x]))</span></code></pre></div>
<div id="compare-multivariate-dependence-structures" class="section level2">
<h2>Compare Multivariate Dependence Structures</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(original.data)</span></code></pre></div>
<pre><code>## [1] 0.4360284</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(new.dep.data)</span></code></pre></div>
<pre><code>## [1] 0.4390859</code></pre>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>If the user is so motivated, detailed arguments and proofs are provided within the following:</p>
<ul>
<li><p><a href="https://www.amazon.com/dp/1490523995/ref=cm_sw_su_dp">Nonlinear Nonparametric Statistics: Using Partial Moments</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=3010414">Nonlinear Correlation and Dependence Using NNS</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=2148522">Deriving Nonlinear Correlation Coefficients from Partial Moments</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=2745308">Beyond Correlation: Using the Elements of Variance for Conditional Means and Probabilities</a></p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
