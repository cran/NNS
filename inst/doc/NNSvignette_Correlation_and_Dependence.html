<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fred Viole" />


<title>Getting Started with NNS: Correlation and Dependence</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Getting Started with NNS: Correlation and Dependence</h1>
<h4 class="author">Fred Viole</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NNS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rgl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(meboot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(plyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tdigest)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dtw)</span></code></pre></div>
<div id="correlation-and-dependence" class="section level1">
<h1>Correlation and Dependence</h1>
<p>The limitations of linear correlation are well known. Often one uses correlation, when dependence is the intended measure for defining the relationship between variables. NNS dependence <strong><code>NNS.dep</code></strong> is a signal:noise measure robust to nonlinear signals.</p>
<p>Below are some examples comparing NNS correlation <strong><code>NNS.cor</code></strong> and <strong><code>NNS.dep</code></strong> with the standard Pearsonâ€™s correlation coefficient <code>cor</code>.</p>
<div id="linear-equivalence" class="section level2">
<h2>Linear Equivalence</h2>
<p>Note the fact that all observations occupy the co-partial moment quadrants.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, .<span class="dv">01</span>) ; y <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> x</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] 1
## 
## $Dependence
## [1] 1</code></pre>
</div>
<div id="nonlinear-relationship" class="section level2">
<h2>Nonlinear Relationship</h2>
<p>Note the fact that all observations occupy the co-partial moment quadrants.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, .<span class="dv">01</span>) ; y <span class="ot">=</span> x <span class="sc">^</span> <span class="dv">10</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 0.6610183</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] 0.9878161
## 
## $Dependence
## [1] 0.9998908</code></pre>
</div>
<div id="dependence" class="section level2">
<h2>Dependence</h2>
<p>Note the fact that all observations occupy only co- or divergent partial moment quadrants for a given subquadrant.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, (x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span> <span class="sc">&gt;=</span> <span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## $Correlation
## [1] -0.3202176
## 
## $Dependence
## [1] 0.9792609</code></pre>
</div>
</div>
<div id="p-values-for-nns.dep" class="section level1">
<h1>p-values for <code>NNS.dep()</code></h1>
<p>p-values and confidence intervals can be obtained from sampling random permutations of <span class="math inline">\(y \rightarrow y_p\)</span> and running <strong><code>NNS.dep(x,$y_p$)</code></strong> to compare against a null hypothesis of 0 correlation, or independence between <span class="math inline">\((x, y)\)</span>.</p>
<p>Simply set <strong><code>NNS.dep(..., p.value = TRUE, print.map = TRUE)</code></strong> to run 100 permutations and plot the results.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p-values for [NNS.dep]</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">1</span>); y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.dep</span>(x, y, <span class="at">p.value =</span> <span class="cn">TRUE</span>, <span class="at">print.map =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>## $Correlation
## [1] 0.09409674
## 
## $`Correlation p.value`
## [1] 0.1
## 
## $`Correlation 95% CIs`
## [1] -0.1247867  0.1592035
## 
## $Dependence
## [1] 0.7151583
## 
## $`Dependence p.value`
## [1] 0
## 
## $`Dependence 95% CIs`
## [1] 0.1115190 0.2905444</code></pre>
</div>
<div id="multivariate-dependence-nns.copula" class="section level1">
<h1>Multivariate Dependence <code>NNS.copula()</code></h1>
<p>These partial moment insights permit us to extend the analysis to multivariate instances and deliver a dependence measure <span class="math inline">\((D)\)</span> such that <span class="math inline">\(D \in [0,1]\)</span>. This level of analysis is simply impossible with Pearson or other rank based correlation methods, which are restricted to bivariate cases.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>); y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>); z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(<span class="fu">cbind</span>(x, y, z), <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">independence.overlay =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.09571785</code></pre>
</div>
<div id="simulating-a-multivariate-dependence-structure" class="section level1">
<h1>Simulating a Multivariate Dependence Structure</h1>
<p>Analogous to an empirical copula transformation, we can generate <code>new data</code> from the dependence structure of our <code>original data</code> via the following steps:</p>
<ul>
<li><strong>Determine the dependence structure:</strong></li>
</ul>
<p>This is accomplished using <strong><code>LPM.ratio(1, x, x)</code></strong> for continuous variables, and <strong><code>LPM.ratio(0, x, x)</code></strong> for discrete variables, which are the empirical CDFs of the marginal variables.</p>
<ul>
<li><strong>Generate or supply <code>new data</code>:</strong></li>
</ul>
<p><code>new data</code> must be of equal dimensions to <code>original data</code>. <code>new data</code> does not have to be of the same distribution as the <code>original data</code>, nor does each dimension of <code>new data</code> have to share a distribution type.</p>
<ul>
<li><strong>Apply dependence structure to <code>new data</code>:</strong></li>
</ul>
<p>We then utilize <strong><code>LPM.VaR(...)</code></strong> to ascertain <code>new data</code> values corresponding to <code>original data</code> position mappings, and return a matrix of these transformed values with the same dimensions as <code>original.data</code>.<br />
<strong><code>LPM.VaR(..., degree = 0, ...)</code></strong> is the discrete transformation and significantly faster than the continuous transformation <strong><code>LPM.VaR(..., degree = 1, ...)</code></strong>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add variable x to original data to avoid total independence (example only)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>original.data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y, z, x)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine dependence structure</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>dep.structure <span class="ot">&lt;-</span> <span class="fu">apply</span>(original.data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">LPM.ratio</span>(<span class="dv">1</span>, x, x))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate new data of equal dimensions to original data with different mean and sd (or distribution)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(original.data), <span class="cf">function</span>(x) <span class="fu">rnorm</span>(<span class="fu">dim</span>(original.data)[<span class="dv">1</span>], <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">20</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply dependence structure to new data</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>new.dep.data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(original.data), <span class="cf">function</span>(x) <span class="fu">LPM.VaR</span>(dep.structure[,x], <span class="dv">1</span>, new.data[,x]))</span></code></pre></div>
<div id="compare-multivariate-dependence-structures" class="section level2">
<h2>Compare Multivariate Dependence Structures</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(original.data)</span></code></pre></div>
<pre><code>## [1] 0.4360284</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NNS.copula</span>(new.dep.data)</span></code></pre></div>
<pre><code>## [1] 0.4390859</code></pre>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>If the user is so motivated, detailed arguments and proofs are provided within the following:</p>
<ul>
<li><p><a href="https://www.amazon.com/dp/1490523995/ref=cm_sw_su_dp">Nonlinear Nonparametric Statistics: Using Partial Moments</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=3010414">Nonlinear Correlation and Dependence Using NNS</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=2148522">Deriving Nonlinear Correlation Coefficients from Partial Moments</a></p></li>
<li><p><a href="https://www.ssrn.com/abstract=2745308">Beyond Correlation: Using the Elements of Variance for Conditional Means and Probabilities</a></p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
